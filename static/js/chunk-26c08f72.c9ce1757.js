(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-26c08f72"],{"01ce":function(e,t,s){},7497:function(e,t,s){"use strict";s.r(t);s("7f7f");var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"higtlight"},[t("section",{staticClass:"about-bg"},[t("img",{directives:[{name:"imgUrl",rawName:"v-imgUrl",value:e.banners[3].url,expression:"banners[3].url"}],staticClass:"bg-img"}),t("div",{staticClass:"bg"}),t("p",{staticClass:"mgs-title"},[e._v("Say Hello~")]),t("div",{staticClass:"input-main"},[t("div",{staticClass:"input-box main"},[t("div",{staticClass:"userbox"},[t("div",{staticClass:"user-img"},[t("img",{attrs:{src:"".concat(e.avatarUrl,"?seed=").concat(e.user.id||"false"),alt:"avatar"}}),t("h4",[e._v(e._s(e.user.name||"未登录"))])])]),t("div",{staticClass:"textbox"},[t("Input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:8},maxlength:400,placeholder:e.textarea},model:{value:e.message.content,callback:function(t){e.$set(e.message,"content",t)},expression:"message.content"}}),t("div",{staticClass:"submit-box"},[t("Button",{attrs:{type:"primary"},on:{click:e.submitMessage}},[t("Icon",{attrs:{type:"ios-create"}}),e._v("\n              提交评论\n            ")],1)],1)],1)])])]),t("SpinLoading",{attrs:{isLoading:e.loading}},[t("section",{staticClass:"main"},[e._l(e.messageList,(function(s,a){return t("div",{key:a,staticClass:"commentList"},[t("div",{staticClass:"user-ava"},[t("img",{attrs:{src:"".concat(e.avatarUrl,"?seed=").concat(s.user.id||"false"),alt:"avatar"}})]),t("div",{staticClass:"comment-main"},[t("div",{staticClass:"comment-box animate03"},[t("div",{staticClass:"username"},[t("span",[t("Icon",{attrs:{type:"md-person"}}),e._v("\n                "+e._s(s.user?s.user.name:s.name?"游客（".concat(s.name,"）"):"游客")+"\n                "),1==s.user_id?t("em",[e._v("(博主)")]):e._e(),t("span",{staticClass:"created"},[t("Icon",{attrs:{type:"ios-time-outline"}}),e._v(e._s(s.created_at)+"\n                ")],1)],1),t("span",{staticClass:"floor"},[e._v(e._s(s.id)+"楼")])]),t("div",{directives:[{name:"highlight",rawName:"v-highlight"}],staticClass:"com_detail",domProps:{innerHTML:e._s(s.content)}}),t("div",{staticClass:"comment-menu"},[t("Poptip",{attrs:{confirm:"",placement:"left",title:"是否删除该留言?"},on:{"on-ok":function(t){return e.deleteComment(s)}}},[s.user_id==e.user.id?t("Icon",{attrs:{type:"md-trash"}}):e._e()],1),t("Tooltip",{attrs:{content:"回复留言"}},[t("i",{staticClass:"iconfont lv-icon-xiaoxi2",on:{click:function(t){return e.handleReply(s,s)}}})])],1),e._l(s.reply,(function(a,n){return t("div",{key:n,staticClass:"reply-box"},[t("p",{staticClass:"reply-header"},[t("span",[e._v("\n                  "+e._s(a.user.name)+"\n                  "),1==a.user.id?t("em",[e._v("(博主)")]):e._e(),t("span",{staticClass:"noml"},[e._v("回复")]),t("span",[e._v(e._s(a.topic_user?a.topic_user.name:"游客"))]),a.topic_user&&1==a.topic_user.id?t("em",[e._v("(博主)")]):e._e(),t("span",{staticClass:"created"},[t("Icon",{attrs:{type:"ios-time-outline"}}),e._v("\n                    "+e._s(s.created_at)+"\n                  ")],1)])]),t("div",{directives:[{name:"highlight",rawName:"v-highlight"}],staticClass:"com_detail",domProps:{innerHTML:e._s(a.content)}}),t("div",{staticClass:"comment-menu"},[t("Poptip",{attrs:{confirm:"",placement:"left",title:"是否删除该留言?"},on:{"on-ok":function(t){return e.deleteReply(a)}}},[a.user_id==e.user.id?t("Icon",{attrs:{type:"md-trash"}}):e._e()],1),t("Tooltip",{attrs:{content:"回复留言"}},[t("i",{staticClass:"iconfont lv-icon-xiaoxi2",on:{click:function(t){return e.handleReply(s,a)}}})])],1)])}))],2),s.id==e.messageId?t("div",{staticClass:"reply-text"},[t("Input",{ref:"textarea",refInFor:!0,attrs:{type:"textarea",autosize:{minRows:3,maxRows:8},maxlength:400,placeholder:e.replyTextarea},model:{value:e.replyContent,callback:function(t){e.replyContent=t},expression:"replyContent"}}),t("div",{staticClass:"reply-button"},[t("Button",{staticClass:"cancel",on:{click:e.cancelReply}},[e._v("\n                取消回复\n              ")]),t("Button",{attrs:{type:"primary"},on:{click:e.submitReply}},[t("Icon",{attrs:{type:"ios-create"}}),e._v("\n                回复留言\n              ")],1)],1)],1):e._e()])])})),e.pageModel.sumCount>10?t("NewPage",{attrs:{pageModel:e.pageModel},on:{selectList:e.selectRoleList}}):e._e()],2)])],1)},n=[],i=(s("8e6e"),s("456d"),s("ac6a"),s("bd86")),c=s("2f62"),o=s("0e54"),r=s.n(o);s("bc07");function l(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,a)}return s}function u(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?l(Object(s),!0).forEach((function(t){Object(i["a"])(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var p={data:function(){return{textarea:"支持markdown语法，尾部2个空格后回车才会换行，最长400个字",replyTextarea:"",replyContent:"",loading:!0,messageList:[],messageId:-1,topicUserId:"",isReply:!1,message:{content:"",name:""},pageModel:{page:1,sumCount:10},page:2,hasMore:!0,avatarUrl:this.$avatarUrl}},computed:u(u({},Object(c["c"])(["user","banners"])),{},{compiledMarkdown:function(){return r()(this.detail.content,{sanitize:!1})}}),created:function(){this.getMessage()},methods:{getMessage:function(){var e=this;this.$api.MessageList(this.pageModel).then((function(t){e.loading=!1,e.pageModel.sumCount=t.data.total,e.messageList=t.data.data,e.messageList.forEach((function(e){e.content=r()(e.content,{sanitize:!1}),e.reply.length>0&&e.reply.forEach((function(e){e.content=r()(e.content,{sanitize:!1})}))}))})).catch((function(){}))},selectRoleList:function(){this.getMessage()},submitMessage:function(){var e=this;this.$api.MessageAdd(this.message).then((function(t){e.message={content:"",name:""},e.$Message.success(t.message),e.pageModel.page=1,e.getMessage()})).catch((function(){}))},deleteComment:function(e){var t=this;this.$api.MessageDelete({id:e.id}).then((function(e){t.$Message.success(e.message),t.getMessage()})).catch((function(){}))},deleteReply:function(e){var t=this;this.$api.MessageReplyDelete({id:e.id}).then((function(e){t.getMessage(),t.$Message.success(e.message)})).catch((function(){}))},handleReply:function(e,t){var s=this;e.user?(this.messageId=e.id,this.topicUserId=t.user.id,this.replyTextarea="回复"+t.user.name+"：",this.replyContent="",setTimeout((function(){s.$refs.textarea[0].focus()}),200)):this.$Message.error("不能回复游客！")},cancelReply:function(){this.messageId=-1},submitReply:function(){var e=this,t={content:this.replyContent,message_id:this.messageId,topic_user_id:this.topicUserId};this.$api.MessageReply(t).then((function(t){e.$Message.success(t),e.getMessage(),e.cancelReply()})).catch((function(){}))}}},d=p,m=(s("7bfd"),s("2877")),g=Object(m["a"])(d,a,n,!1,null,"73e27c72",null);t["default"]=g.exports},"7bfd":function(e,t,s){"use strict";s("01ce")},bc07:function(e,t,s){}}]);